# M3U8/MP4 批量下载工具

一个功能强大的视频批量下载工具，支持M3U8和MP4格式，具有现代化的GUI界面和视频播放功能。

## 功能特点

### 🎯 核心功能
- **批量下载**: 支持M3U8和MP4格式的批量下载
- **拖拽操作**: 直接拖拽包含链接的文本文件到界面
- **智能解析**: 自动从文本中提取视频链接
- **顺序命名**: 下载文件按1.mp4、2.mp4...顺序命名
- **自定义目录**: 可选择输出目录和创建子文件夹

### 🎬 视频播放
- **内置播放器**: 右侧集成视频播放区域
- **直接播放**: 双击MP4链接可直接播放
- **播放控制**: 支持播放/暂停/停止操作
- **音量调节**: 内置音量控制滑块

### 🎨 界面设计
- **现代化UI**: 使用ttk组件，界面美观
- **实时进度**: 显示单个文件和总体下载进度
- **状态监控**: 实时显示每个文件的下载状态
- **表格展示**: 清晰的下载列表管理

### ⚙️ 高级功能
- **FFmpeg集成**: 使用本地FFmpeg处理M3U8文件
- **多线程下载**: 后台多线程处理，界面不卡顿
- **错误处理**: 完善的异常处理和用户提示
- **一键清空**: 快速清空所有下载任务

## 安装要求

### Python环境
- Python 3.7+

### 依赖库
```bash
pip install -r requirements.txt
```

### FFmpeg工具
确保以下文件在脚本目录下：
- `ffmpeg.exe`
- `ffplay.exe` 
- `ffprobe.exe`

## 使用方法

### 1. 启动程序
```bash
python video_downloader.py
```

### 2. 添加下载链接
- **方法一**: 拖拽包含链接的文本文件到左侧拖拽区域
- **方法二**: 直接在拖拽区域粘贴视频链接
- **方法三**: 拖拽包含链接的表格文件

### 3. 设置输出目录
- 点击"选择输出目录"按钮选择保存位置
- 可选择"创建子文件夹"来组织文件

### 4. 开始下载
- 点击"开始下载"按钮启动批量下载
- 可随时点击"停止下载"中断任务
- 下载完成后可点击"打开下载目录"查看文件

### 5. 视频播放
- 双击下载列表中的MP4链接可直接播放
- 使用右侧播放器控制播放/暂停/停止
- 调节音量滑块控制播放音量

## 支持格式

### 输入格式
- M3U8流媒体链接
- MP4直链
- 包含视频链接的文本文件
- 表格文件（自动提取链接）

### 输出格式
- MP4视频文件
- 按序号命名：1.mp4, 2.mp4, 3.mp4...

## 界面说明

### 左侧面板
- **拖拽区域**: 显示和处理输入的链接
- **控制按钮**: 输出目录、文件夹创建、清空等操作
- **下载列表**: 表格形式显示所有下载任务
- **进度条**: 显示总体下载进度

### 右侧面板
- **视频播放器**: 黑色播放区域
- **播放控制**: 播放/暂停/停止按钮
- **音量控制**: 音量调节滑块
- **播放信息**: 当前播放文件信息

## 注意事项

1. **FFmpeg依赖**: 确保FFmpeg工具在程序目录下
2. **网络连接**: 下载需要稳定的网络连接
3. **存储空间**: 确保有足够的磁盘空间
4. **链接有效性**: 确保视频链接可访问
5. **格式支持**: 主要支持M3U8和MP4格式

## 故障排除

### 常见问题
1. **无法下载M3U8**: 检查FFmpeg是否正确安装
2. **播放失败**: 确认FFplay.exe在程序目录
3. **拖拽无效**: 检查文件编码是否为UTF-8
4. **下载中断**: 检查网络连接和链接有效性

### 错误处理
- 程序会显示详细的错误信息
- 失败的下载会在列表中标记为"失败"
- 可重新启动下载继续未完成的任务

## 更新日志

### v2.0
- 全新的现代化GUI界面
- 集成视频播放器功能
- 优化下载逻辑和错误处理
- 添加拖拽功能和实时进度显示
- 支持自定义输出目录和文件夹创建

## 技术特性

- **GUI框架**: Tkinter + TTK
- **拖拽支持**: TkinterDnD2
- **视频处理**: FFmpeg
- **网络请求**: Requests
- **M3U8解析**: m3u8库
- **多线程**: Threading
- **图像处理**: PIL/Pillow

---

**开发者**: AI Assistant  
**版本**: 2.0  
**更新时间**: 2024年
